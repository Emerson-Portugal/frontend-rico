"use strict";(self.webpackChunksertchile=self.webpackChunksertchile||[]).push([[423],{5423:(E,p,r)=>{r.d(p,{wR:()=>M,Gf:()=>S,fS:()=>F});var e=r(4438),g=r(5416),d=r(8498),u=r(3849),c=r(8119),n=r(6549);let m=(()=>{class o{constructor(){this.title="Turnos",this.icon="mat:access_time",this.tabs=[{label:"Informacion General",onClick:()=>{},active:!0,disabled:!1}]}static{this.\u0275fac=function(i){return new(i||o)}}static{this.\u0275cmp=e.VBU({type:o,selectors:[["app-shift-form-header"]],standalone:!0,features:[e.aNF],decls:1,vars:3,consts:[[3,"title","icon","tabs"]],template:function(i,t){1&i&&e.nrm(0,"app-custom-form-header",0),2&i&&e.Y8G("title",t.title)("icon",t.icon)("tabs",t.tabs)},dependencies:[n.U$]})}}return o})();var l=r(9417),y=r(9042),v=r(2153),B=function(o){return o.MA\u00d1ANA="MA\xd1ANA",o.TARDE="TARDE",o.NOCHE="NOCHE",o}(B||{});let C=(()=>{class o{constructor(){this.fb=(0,e.WQX)(l.ok),this.code=(0,e.geq)(""),this.isCreate=(0,e.geq)(!0),this.shifts=e.geq.required(),this.form=this.fb.group({code:["",[l.k0.required,l.k0.pattern(c.Dk.ALPHA_NUMERIC)]],shift:["",[l.k0.required]],start_time:["",[l.k0.required]],end_time:["",[l.k0.required]]}),this.ShiftTypeEnum=v.AF.toCustomSelectContent(B),this.formSubscription=null,this.updateFormValuesEffect=(0,e.QZP)(()=>{if(this.isCreate())return;const s=this.shifts();!s||v.zf.isObjectEmpty(s)||(this.form.patchValue({code:this.code(),shift:s.shift,start_time:String(s.start_time),end_time:String(s.end_time)}),this.updateFormValuesEffect.destroy())}),this.updateCodeStatusEffect=(0,e.QZP)(()=>{this.isCreate()||(this.form.get("code").disable(),this.updateCodeStatusEffect.destroy())})}ngOnInit(){this.formSubscription=this.form.valueChanges.subscribe(()=>{"code"in this.shifts()?this.shifts.update(s=>({...s,code:this.form.get("code").value??"",shift:this.form.get("shift").value??"",start_time:this.form.get("start_time").value??"",end_time:this.form.get("end_time").value??""})):this.shifts.update(s=>({...s,shift:this.form.get("shift").value??"",start_time:this.form.get("start_time").value??"",end_time:this.form.get("end_time").value??""}))})}ngOnDestroy(){this.formSubscription?.unsubscribe()}static{this.\u0275fac=function(i){return new(i||o)}}static{this.\u0275cmp=e.VBU({type:o,selectors:[["app-shift-form-body"]],inputs:{code:[e.Mj6.SignalBased,"code"],isCreate:[e.Mj6.SignalBased,"isCreate"],shifts:[e.Mj6.SignalBased,"shifts"]},outputs:{code:"codeChange",isCreate:"isCreateChange",shifts:"shiftsChange"},standalone:!0,features:[e.aNF],decls:6,vars:7,consts:[[1,"flex","w-full","card"],[1,"flex","w-1/2","flex-col","mx-5","py-5","gap-y-5",3,"formGroup"],["label","C\xf3digo","controlName","code",3,"form","disabled"],["label","Tuno","controlName","shift",3,"form","dropDownItems"],["controlName","start_time","label","Hora de inicio","icon","mat:access_time","inputClass","mt-2",3,"form"],["controlName","end_time","label","Hora de fin","icon","mat:access_time","inputClass","mt-2",3,"form"]],template:function(i,t){1&i&&(e.j41(0,"div",0)(1,"form",1),e.nrm(2,"app-custom-input",2)(3,"app-custom-select",3)(4,"app-custom-hour",4)(5,"app-custom-hour",5),e.k0s()()),2&i&&(e.R7$(),e.Y8G("formGroup",t.form),e.R7$(),e.Y8G("form",t.form)("disabled",!0),e.R7$(),e.Y8G("form",t.form)("dropDownItems",t.ShiftTypeEnum),e.R7$(),e.Y8G("form",t.form),e.R7$(),e.Y8G("form",t.form))},dependencies:[n.H7,n.fp,n.Ft,l.X1,l.qT,l.cb,l.j4,y.fS]})}}return o})();function w(o,V){1&o&&e.nrm(0,"app-shift-form-header")}let M=(()=>{class o{constructor(){this.shiftService=(0,e.WQX)(u.E),this.snackBar=(0,e.WQX)(g.UG),this.router=(0,e.WQX)(d.Ix),this.route=(0,e.WQX)(d.nX),this.code=(0,e.hFB)(""),this.shifts=(0,e.geq)({shift:"",start_time:"",end_time:""}),this.showToolbar=(0,e.hFB)(!0),this.showBreadcrumbs=(0,e.hFB)(!0),this.showActionButtons=(0,e.hFB)(!0),this.showHeader=(0,e.geq)(!0),this.editViewMode=(0,e.geq)(c.A0.VIEW_ONLY),this.isCreate=(0,e.EWP)(()=>!this.code()),this.canEdit=(0,e.EWP)(()=>this.editViewMode()!==c.A0.VIEW_ONLY),this.child=(0,e.ebz)(C),this.fetchShiftEffect=(0,e.QZP)(()=>{this.code()&&(this.getByCode(),this.fetchShiftEffect.destroy())})}getByCode(){this.shiftService.getByCode(this.code()).subscribe({next:({data:s})=>{this.shifts.set({shift:s.shift,start_time:s.start_time,end_time:s.end_time})}})}onSaveElement(){const s=this.shifts();if(s){if(this.isCreate())return void this.shiftService.create(s).subscribe({next:()=>{this.snackBar.open("El turno se creo correctamente","OK",{duration:3e3}),this.onCleanUp()}});this.shiftService.update(this.code(),s).subscribe({next:()=>{this.snackBar.open("El turno se actualizo correctamente","OK",{duration:3e3}),this.onCleanUp()}})}}onDeleteElement(){this.shiftService.delete(this.code()).subscribe({next:()=>{this.snackBar.open("El turno se elimino correctamente","OK",{duration:3e3}),this.router.navigate(["../../"],{relativeTo:this.route})}})}onCleanUp(){if(this.isCreate())return this.shifts.set({shift:"",start_time:"",end_time:""}),void this.child()?.form.reset();this.editViewMode.set(c.A0.VIEW_ONLY)}static{this.\u0275fac=function(i){return new(i||o)}}static{this.\u0275cmp=e.VBU({type:o,selectors:[["app-shift-form"]],viewQuery:function(i,t){1&i&&e.wEZ(t.child,C,5),2&i&&e.NyB()},inputs:{code:[e.Mj6.SignalBased,"code"],shifts:[e.Mj6.SignalBased,"shifts"],showToolbar:[e.Mj6.SignalBased,"showToolbar"],showBreadcrumbs:[e.Mj6.SignalBased,"showBreadcrumbs"],showActionButtons:[e.Mj6.SignalBased,"showActionButtons"],showHeader:[e.Mj6.SignalBased,"showHeader"],editViewMode:[e.Mj6.SignalBased,"editViewMode"]},outputs:{shifts:"shiftsChange",showHeader:"showHeaderChange",editViewMode:"editViewModeChange"},standalone:!0,features:[e.aNF],decls:3,vars:10,consts:[["customClasses","flex flex-col gap-y-5 bg-transparent shadow-none","title","Tipo de Maquinas",3,"editViewModeChange","saveElement","deleteElement","showActionButtons","showBreadcrumbs","showToolbar","editViewMode"],[3,"shiftsChange","shifts","code","isCreate"]],template:function(i,t){1&i&&(e.j41(0,"app-custom-layout",0),e.mxI("editViewModeChange",function(h){return e.DH7(t.editViewMode,h)||(t.editViewMode=h),h}),e.bIt("saveElement",function(){return t.onSaveElement()})("deleteElement",function(){return t.onDeleteElement()}),e.DNE(1,w,1,0,"app-shift-form-header"),e.j41(2,"app-shift-form-body",1),e.mxI("shiftsChange",function(h){return e.DH7(t.shifts,h)||(t.shifts=h),h}),e.k0s()()),2&i&&(e.Y8G("showActionButtons",t.showActionButtons())("showBreadcrumbs",t.showBreadcrumbs())("showToolbar",t.showToolbar()),e.R50("editViewMode",t.editViewMode),e.R7$(),e.vxM(1,t.showHeader()?1:-1),e.R7$(),e.AVh("disabled",!t.canEdit()),e.R50("shifts",t.shifts),e.Y8G("code",t.code())("isCreate",t.isCreate()))},dependencies:[m,C,n.jc]})}}return o})();var T=r(1626);let S=(()=>{class o{constructor(){this.shiftService=(0,e.WQX)(u.E),this.title="Tipo de Turno",this.columns=[{label:"ID",property:"id",type:"text",visible:!0,cssClasses:["font-medium"]},{label:"Codigo",property:"code",type:"text",visible:!0,cssClasses:["font-medium"]},{label:"Turno",property:"shift",type:"text",visible:!0},{label:"Hora Inicio",property:"start_time",type:"text",visible:!0},{label:"Hora Fin",property:"end_time",type:"text",visible:!0}],this.paginator=(0,e.vPA)({currentPage:1,pageSize:10,totalCount:0,totalPages:0}),this.shifts=(0,e.vPA)([]),this.getSelectedBehaviour=(0,e.hFB)(c.qm.KEEP_BEHAVIOUR),this.getSelected=(0,e.CGW)(),this.createBehaviour=(0,e.hFB)(c.qm.KEEP_BEHAVIOUR),this.create=(0,e.CGW)()}ngOnInit(){this.getAll()}getAll(s=""){const i=this.paginator(),t=(new T.Nl).set("page",i.currentPage).set("pageSize",i.pageSize).set("shift",s);this.shiftService.getAll(t).subscribe({next:({data:a})=>{this.shifts.set(a.results),this.paginator.set({currentPage:a.pageNumber,pageSize:a.pageSize,totalCount:a.totalCount,totalPages:a.totalPages})}})}onCurrentPageChange(s){this.paginator.update(i=>({...i,currentPage:s})),this.getAll()}onSearchByText(s){this.paginator.update(i=>({...i,currentPage:1})),this.getAll(s)}static{this.\u0275fac=function(i){return new(i||o)}}static{this.\u0275cmp=e.VBU({type:o,selectors:[["app-shift-list"]],inputs:{getSelectedBehaviour:[e.Mj6.SignalBased,"getSelectedBehaviour"],createBehaviour:[e.Mj6.SignalBased,"createBehaviour"]},outputs:{getSelected:"getSelected",create:"create"},standalone:!0,features:[e.aNF],decls:1,vars:6,consts:[[3,"elementsChange","changeCurrentPage","rowClickCustomBehaviour","createElementCustomBehaviour","searchByText","title","elements","columns","paginator","rowClickBehaviour","createElementBehaviour"]],template:function(i,t){1&i&&(e.j41(0,"app-custom-table",0),e.mxI("elementsChange",function(h){return e.DH7(t.shifts,h)||(t.shifts=h),h}),e.bIt("changeCurrentPage",function(h){return t.onCurrentPageChange(h)})("rowClickCustomBehaviour",function(h){return t.getSelected.emit(h)})("createElementCustomBehaviour",function(){return t.create.emit()})("searchByText",function(h){return t.onSearchByText(h)}),e.k0s()),2&i&&(e.Y8G("title",t.title),e.R50("elements",t.shifts),e.Y8G("columns",t.columns)("paginator",t.paginator())("rowClickBehaviour",t.getSelectedBehaviour())("createElementBehaviour",t.createBehaviour()))},dependencies:[n.rR]})}}return o})();var f=r(4006),_=r(8834),b=r(9213);function A(o,V){if(1&o){const s=e.RV6();e.j41(0,"app-shift-list",4),e.bIt("getSelected",function(t){e.eBV(s);const a=e.XpG();return e.Njj(a.onSelectElement(t))})("create",function(){e.eBV(s);const t=e.XpG();return e.Njj(t.toggleViewMode())}),e.k0s()}if(2&o){const s=e.XpG();e.Y8G("getSelectedBehaviour",s.CustomBehaviourEnum.CHANGE_BEHAVIOUR)("createBehaviour",s.CustomBehaviourEnum.CHANGE_BEHAVIOUR)}}let F=(()=>{class o{constructor(){this.dialogRef=(0,e.WQX)(f.CP),this.shiftService=(0,e.WQX)(u.E),this.title="Tipo de Turno",this.EditViewModeEnum=c.A0,this.CustomBehaviourEnum=c.qm,this.viewMode=(0,e.vPA)("list")}onSelectElement(s){this.dialogRef.close(s)}getShiftByCode(s){this.shiftService.getByCode(s).subscribe({next:({data:i})=>this.dialogRef.close(i)})}toggleViewMode(){this.viewMode.set("list")}static{this.\u0275fac=function(i){return new(i||o)}}static{this.\u0275cmp=e.VBU({type:o,selectors:[["app-shift-modal"]],standalone:!0,features:[e.aNF],decls:7,vars:2,consts:[["mat-dialog-title","",1,"flex","items-center"],[1,"headline","m-0","flex-auto"],["mat-dialog-close","","mat-icon-button","","type","button",1,"text-secondary"],["svgIcon","mat:close"],[3,"getSelected","create","getSelectedBehaviour","createBehaviour"]],template:function(i,t){if(1&i&&(e.j41(0,"div",0)(1,"h2",1),e.EFF(2),e.k0s(),e.j41(3,"button",2),e.nrm(4,"mat-icon",3),e.k0s()(),e.j41(5,"mat-dialog-content"),e.DNE(6,A,1,2),e.k0s()),2&i){let a;e.R7$(2),e.JRh(t.title),e.R7$(4),e.vxM(6,"list"===(a=t.viewMode())?6:-1)}},dependencies:[S,_.Hl,_.iY,f.hM,f.tx,f.BI,f.Yi,b.m_,b.An]})}}return o})()},3849:(E,p,r)=>{r.d(p,{E:()=>d});var e=r(4438),g=r(6921);let d=(()=>{class u{constructor(){this.api=(0,e.WQX)(g.G),this.url="produccion/turnos"}getAll(n){return this.api.getAll(`${this.url}/`,n)}getByCode(n){return this.api.get(`${this.url}/${n}/`)}create(n){return this.api.post(`${this.url}/`,n)}update(n,m){return this.api.put(`${this.url}/${n}/`,m)}delete(n){return this.api.delete(`${this.url}/${n}/`)}static{this.\u0275fac=function(m){return new(m||u)}}static{this.\u0275prov=e.jDH({token:u,factory:u.\u0275fac,providedIn:"root"})}}return u})()}}]);