"use strict";(self.webpackChunksertchile=self.webpackChunksertchile||[]).push([[45],{2045:(E,g,i)=>{i.d(g,{FQ:()=>S,tj:()=>B,MB:()=>T});var e=i(4438),f=i(5416),m=i(8498),u=i(5333),d=i(8119),c=i(6549);let p=(()=>{class s{constructor(){this.title="Productos",this.icon="mat:shopping_cart",this.tabs=[{label:"Informacion General",onClick:()=>{},active:!0,disabled:!1}]}static{this.\u0275fac=function(r){return new(r||s)}}static{this.\u0275cmp=e.VBU({type:s,selectors:[["app-product-header"]],standalone:!0,features:[e.aNF],decls:1,vars:3,consts:[[3,"title","icon","tabs"]],template:function(r,t){1&r&&e.nrm(0,"app-custom-form-header",0),2&r&&e.Y8G("title",t.title)("icon",t.icon)("tabs",t.tabs)},dependencies:[c.U$]})}}return s})();var l=i(9417),P=i(9042),w=i(2153);let C=(()=>{class s{constructor(){this.fb=(0,e.WQX)(l.ok),this.code=(0,e.geq)(""),this.isCreate=(0,e.geq)(!0),this.product=e.geq.required(),this.form=this.fb.group({code:["",[l.k0.required,l.k0.pattern(d.Dk.TEXT_ONLY)]],name:["",[l.k0.required,l.k0.pattern(d.Dk.TEXT_ONLY)]]}),this.formSubscription=null,this.updateFormValuesEffect=(0,e.QZP)(()=>{if(this.isCreate())return;const o=this.product();!o||w.zf.isObjectEmpty(o)||(this.form.patchValue({code:this.code(),name:o.name}),this.updateFormValuesEffect.destroy())}),this.updateCodeStatusEffect=(0,e.QZP)(()=>{this.isCreate()||(this.form.get("code").disable(),this.updateCodeStatusEffect.destroy())})}ngOnInit(){this.formSubscription=this.form.valueChanges.subscribe(()=>{"code"in this.product()?this.product.update(o=>({...o,code:this.form.get("code").value??"",name:this.form.get("name").value??""})):this.product.update(o=>({...o,name:this.form.get("name").value??""}))})}ngOnDestroy(){this.formSubscription?.unsubscribe()}static{this.\u0275fac=function(r){return new(r||s)}}static{this.\u0275cmp=e.VBU({type:s,selectors:[["app-product-body"]],inputs:{code:[e.Mj6.SignalBased,"code"],isCreate:[e.Mj6.SignalBased,"isCreate"],product:[e.Mj6.SignalBased,"product"]},outputs:{code:"codeChange",isCreate:"isCreateChange",product:"productChange"},standalone:!0,features:[e.aNF],decls:4,vars:3,consts:[[1,"flex","w-full","card"],[1,"flex","w-1/2","flex-col","mx-5","py-5","gap-y-5",3,"formGroup"],["label","C\xf3digo","controlName","code",3,"form"],["label","Nombre","controlName","name",3,"form"]],template:function(r,t){1&r&&(e.j41(0,"div",0)(1,"form",1),e.nrm(2,"app-custom-input",2)(3,"app-custom-input",3),e.k0s()()),2&r&&(e.R7$(),e.Y8G("formGroup",t.form),e.R7$(),e.Y8G("form",t.form),e.R7$(),e.Y8G("form",t.form))},dependencies:[c.H7,l.X1,l.qT,l.cb,l.j4,P.fS]})}}return s})();function y(s,V){1&s&&e.nrm(0,"app-product-header")}let S=(()=>{class s{constructor(){this.productService=(0,e.WQX)(u.b),this.snackBar=(0,e.WQX)(f.UG),this.router=(0,e.WQX)(m.Ix),this.route=(0,e.WQX)(m.nX),this.code=(0,e.hFB)(""),this.product=(0,e.geq)({code:this.code(),name:""}),this.showToolbar=(0,e.hFB)(!0),this.showBreadcrumbs=(0,e.hFB)(!0),this.showActionButtons=(0,e.hFB)(!0),this.showHeader=(0,e.geq)(!0),this.editViewMode=(0,e.geq)(d.A0.VIEW_ONLY),this.isCreate=(0,e.EWP)(()=>!this.code()),this.canEdit=(0,e.EWP)(()=>this.editViewMode()!==d.A0.VIEW_ONLY),this.child=(0,e.ebz)(C),this.fetchProductEffect=(0,e.QZP)(()=>{this.code()&&(this.getByCode(),this.fetchProductEffect.destroy())})}getByCode(){this.productService.getByCode(this.code()).subscribe({next:({data:o})=>{this.product.set({code:o.code,name:o.name})}})}onSaveElement(){const o=this.product();if(o){if(this.isCreate())return void this.productService.create(o).subscribe({next:()=>{this.snackBar.open("El producto se creo correctamente","OK",{duration:3e3}),this.onCleanUp()}});this.productService.update(this.code(),o).subscribe({next:()=>{this.snackBar.open("El producto se actualizo correctamente","OK",{duration:3e3}),this.onCleanUp()}})}}onDeleteElement(){this.productService.delete(this.code()).subscribe({next:()=>{this.snackBar.open("El producto se elimino correctamente","OK",{duration:3e3}),this.router.navigate(["../../"],{relativeTo:this.route})}})}onCleanUp(){if(this.isCreate())return this.product.set({code:"",name:""}),void this.child()?.form.reset();this.editViewMode.set(d.A0.VIEW_ONLY)}static{this.\u0275fac=function(r){return new(r||s)}}static{this.\u0275cmp=e.VBU({type:s,selectors:[["app-product-form"]],viewQuery:function(r,t){1&r&&e.wEZ(t.child,C,5),2&r&&e.NyB()},inputs:{code:[e.Mj6.SignalBased,"code"],product:[e.Mj6.SignalBased,"product"],showToolbar:[e.Mj6.SignalBased,"showToolbar"],showBreadcrumbs:[e.Mj6.SignalBased,"showBreadcrumbs"],showActionButtons:[e.Mj6.SignalBased,"showActionButtons"],showHeader:[e.Mj6.SignalBased,"showHeader"],editViewMode:[e.Mj6.SignalBased,"editViewMode"]},outputs:{product:"productChange",showHeader:"showHeaderChange",editViewMode:"editViewModeChange"},standalone:!0,features:[e.aNF],decls:3,vars:10,consts:[["customClasses","flex flex-col gap-y-5 bg-transparent shadow-none","title","Tipos de Productos",3,"editViewModeChange","saveElement","deleteElement","showActionButtons","showBreadcrumbs","showToolbar","editViewMode"],[3,"productChange","product","code","isCreate"]],template:function(r,t){1&r&&(e.j41(0,"app-custom-layout",0),e.mxI("editViewModeChange",function(n){return e.DH7(t.editViewMode,n)||(t.editViewMode=n),n}),e.bIt("saveElement",function(){return t.onSaveElement()})("deleteElement",function(){return t.onDeleteElement()}),e.DNE(1,y,1,0,"app-product-header"),e.j41(2,"app-product-body",1),e.mxI("productChange",function(n){return e.DH7(t.product,n)||(t.product=n),n}),e.k0s()()),2&r&&(e.Y8G("showActionButtons",t.showActionButtons())("showBreadcrumbs",t.showBreadcrumbs())("showToolbar",t.showToolbar()),e.R50("editViewMode",t.editViewMode),e.R7$(),e.vxM(1,t.showHeader()?1:-1),e.R7$(),e.AVh("disabled",!t.canEdit()),e.R50("product",t.product),e.Y8G("code",t.code())("isCreate",t.isCreate()))},dependencies:[p,C,c.jc]})}}return s})();var _=i(1626);let B=(()=>{class s{constructor(){this.productService=(0,e.WQX)(u.b),this.title="Tipo de Producto",this.columns=[{label:"ID",property:"id",type:"text",visible:!0,cssClasses:["font-medium"]},{label:"Codigo",property:"code",type:"text",visible:!0,cssClasses:["font-medium"]},{label:"Nombre",property:"name",type:"text",visible:!0}],this.paginator=(0,e.vPA)({currentPage:1,pageSize:10,totalCount:0,totalPages:0}),this.products=(0,e.vPA)([]),this.getSelectedBehaviour=(0,e.hFB)(d.qm.KEEP_BEHAVIOUR),this.getSelected=(0,e.CGW)(),this.createBehaviour=(0,e.hFB)(d.qm.KEEP_BEHAVIOUR),this.create=(0,e.CGW)()}ngOnInit(){this.getAll()}getAll(o=""){const r=this.paginator(),t=(new _.Nl).set("page",r.currentPage).set("pageSize",r.pageSize).set("name",o);this.productService.getAll(t).subscribe({next:({data:a})=>{this.products.set(a.results),this.paginator.set({currentPage:a.pageNumber,pageSize:a.pageSize,totalCount:a.totalCount,totalPages:a.totalPages})}})}onCurrentPageChange(o){this.paginator.update(r=>({...r,currentPage:o})),this.getAll()}onSearchByText(o){this.paginator.update(r=>({...r,currentPage:1})),this.getAll(o)}static{this.\u0275fac=function(r){return new(r||s)}}static{this.\u0275cmp=e.VBU({type:s,selectors:[["app-product-list"]],inputs:{getSelectedBehaviour:[e.Mj6.SignalBased,"getSelectedBehaviour"],createBehaviour:[e.Mj6.SignalBased,"createBehaviour"]},outputs:{getSelected:"getSelected",create:"create"},standalone:!0,features:[e.aNF],decls:1,vars:6,consts:[[3,"elementsChange","changeCurrentPage","rowClickCustomBehaviour","createElementCustomBehaviour","searchByText","title","elements","columns","paginator","rowClickBehaviour","createElementBehaviour"]],template:function(r,t){1&r&&(e.j41(0,"app-custom-table",0),e.mxI("elementsChange",function(n){return e.DH7(t.products,n)||(t.products=n),n}),e.bIt("changeCurrentPage",function(n){return t.onCurrentPageChange(n)})("rowClickCustomBehaviour",function(n){return t.getSelected.emit(n)})("createElementCustomBehaviour",function(){return t.create.emit()})("searchByText",function(n){return t.onSearchByText(n)}),e.k0s()),2&r&&(e.Y8G("title",t.title),e.R50("elements",t.products),e.Y8G("columns",t.columns)("paginator",t.paginator())("rowClickBehaviour",t.getSelectedBehaviour())("createElementBehaviour",t.createBehaviour()))},dependencies:[c.rR]})}}return s})();var h=i(4006),v=i(8834),b=i(9213);function M(s,V){if(1&s){const o=e.RV6();e.j41(0,"app-product-list",4),e.bIt("getSelected",function(t){e.eBV(o);const a=e.XpG();return e.Njj(a.onSelectElement(t))})("create",function(){e.eBV(o);const t=e.XpG();return e.Njj(t.toggleViewMode())}),e.k0s()}if(2&s){const o=e.XpG();e.Y8G("getSelectedBehaviour",o.CustomBehaviourEnum.CHANGE_BEHAVIOUR)("createBehaviour",o.CustomBehaviourEnum.CHANGE_BEHAVIOUR)}}let T=(()=>{class s{constructor(){this.dialogRef=(0,e.WQX)(h.CP),this.productService=(0,e.WQX)(u.b),this.title="Tipo de Producto",this.EditViewModeEnum=d.A0,this.CustomBehaviourEnum=d.qm,this.viewMode=(0,e.vPA)("list")}onSelectElement(o){this.dialogRef.close(o)}getProductByCode(o){this.productService.getByCode(o).subscribe({next:({data:r})=>this.dialogRef.close(r)})}toggleViewMode(){this.viewMode.set("list")}static{this.\u0275fac=function(r){return new(r||s)}}static{this.\u0275cmp=e.VBU({type:s,selectors:[["app-product-modal"]],standalone:!0,features:[e.aNF],decls:7,vars:2,consts:[["mat-dialog-title","",1,"flex","items-center"],[1,"headline","m-0","flex-auto"],["mat-dialog-close","","mat-icon-button","","type","button",1,"text-secondary"],["svgIcon","mat:close"],[3,"getSelected","create","getSelectedBehaviour","createBehaviour"]],template:function(r,t){if(1&r&&(e.j41(0,"div",0)(1,"h2",1),e.EFF(2),e.k0s(),e.j41(3,"button",2),e.nrm(4,"mat-icon",3),e.k0s()(),e.j41(5,"mat-dialog-content"),e.DNE(6,M,1,2),e.k0s()),2&r){let a;e.R7$(2),e.JRh(t.title),e.R7$(4),e.vxM(6,"list"===(a=t.viewMode())?6:-1)}},dependencies:[B,v.Hl,v.iY,h.hM,h.tx,h.BI,h.Yi,b.m_,b.An]})}}return s})()},5333:(E,g,i)=>{i.d(g,{b:()=>m});var e=i(4438),f=i(6921);let m=(()=>{class u{constructor(){this.api=(0,e.WQX)(f.G),this.url="produccion/productos"}getAll(c){return this.api.getAll(`${this.url}/`,c)}getByCode(c){return this.api.get(`${this.url}/${c}/`)}create(c){return this.api.post(`${this.url}/`,c)}update(c,p){return this.api.put(`${this.url}/${c}/`,p)}delete(c){return this.api.delete(`${this.url}/${c}/`)}static{this.\u0275fac=function(p){return new(p||u)}}static{this.\u0275prov=e.jDH({token:u,factory:u.\u0275fac,providedIn:"root"})}}return u})()}}]);